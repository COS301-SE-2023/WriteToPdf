import {
  AfterViewInit,
  Component,
  ElementRef,
  OnInit,
  ViewChild,
} from '@angular/core';
import { Router } from '@angular/router';
import { MenuItem } from 'primeng/api';
import { FileUploadPopupComponent } from '../file-upload-popup/file-upload-popup.component';
import { Clipboard } from '@angular/cdk/clipboard';
import { DialogService } from 'primeng/dynamicdialog';
import { FileService } from '../services/file.service';
import { EditService } from '../services/edit.service';
import { AssetService } from '../services/asset.service';
import { Inject } from '@angular/core';
import { MessageService } from 'primeng/api';
import { set } from 'cypress/types/lodash';
import { PageBreak } from '@ckeditor/ckeditor5-page-break';

import html2pdf from 'html2pdf.js/dist/html2pdf';

import DecoupledEditor from '@ckeditor/ckeditor5-build-decoupled-document';

@Component({
  selector: 'app-edit',
  templateUrl: './edit.component.html',
  styleUrls: ['./edit.component.scss'],
})
export class EditComponent implements AfterViewInit, OnInit {
  fileName: string | undefined = '';
  text: any;
  sidebarVisible: boolean = true;
  currentZoom: number = 1;
  exportDialogVisible: boolean = false;
  public speedDialItems!: MenuItem[];
  assets: any[] = [];
  textFromAsset: any[] = [];
  textCopyDialog: boolean = false;
  mock: string = '{ "$metadata": { "httpStatusCode": 200, "requestId": "c738f6e8-99e3-401e-a451-e6a3a1da2fa3", "attempts": 1, "totalRetryDelay": 0 }, "AnalyzeDocumentModelVersion": "1.0", "Blocks": [{ "BlockType": "PAGE", "Geometry": { "BoundingBox": { "Height": 1, "Left": 0.0024194824509322643, "Top": 0, "Width": 0.9975805282592773 }, "Polygon": [{ "X": 0.0024194824509322643, "Y": 0.00713935075327754 }, { "X": 0.9982098340988159, "Y": 0 }, { "X": 1, "Y": 0.9931807518005371 }, { "X": 0.0052367947064340115, "Y": 1 }] }, "Id": "c845891d-b8a8-45c3-9380-b8b5b783071d", "Relationships": [{ "Ids": ["357f0997-c79d-4c67-9aad-038fcca42fb1", "93649026-87f0-4ad6-8290-9b0fc6c81ddd", "88b1fba0-94b0-44ba-8fd4-4ef0c10e47b1", "7562a8ec-3c1b-4c2a-bace-58ae3e8f0d72", "ee0d74a5-7373-46bc-a348-0245e3624152", "261dbe58-2711-46b1-a1a2-d8d1f604b0a5", "c1283b92-f238-4e97-b5c8-b2ee29bad6ab", "9ec22769-61b4-4f52-9fd5-740cb5fc4e1e", "830e8b1f-ad06-49fd-94f5-f0da248775e3", "6062d954-1eec-496b-9eae-23d928af87b8", "ac672918-1093-44b5-a490-9f7987b23106", "4c68da93-b090-4d77-9f89-f602c86b0262", "3eb17212-add5-4175-89dd-52acfeed024f", "9c02f9d6-9048-4a0e-a8b8-5a1bb268f8c6", "41f4eae9-9c7b-4237-9244-35241b8ed71e", "4dcb9f58-fbd3-4aec-a9b2-59589bda2aa9", "97d18cfc-a11a-4bd7-8a81-c7829deb202b", "f23d4390-20ed-4834-918c-d7aecea969f2", "657d0005-4492-4a07-b853-6a319fc3c394", "06ae3aac-7a1e-4d39-aa55-661f0acb2f1c", "925c6296-219e-4ae1-80d9-e759e21b86f5", "eee9c1b6-0acc-4ba1-8569-c3b817d1b19f", "a34f8ac7-9821-49c6-9718-fcfadc203bfb", "bee23dd9-6d10-4558-9b85-a9dc20f59355", "d569d7e8-8563-403e-a860-b86e2e7face3"], "Type": "CHILD" }] }, { "BlockType": "LINE", "Confidence": 85.21019744873047, "Geometry": { "BoundingBox": { "Height": 0.11645128577947617, "Left": 0.009432097896933556, "Top": 0.015392506495118141, "Width": 0.042739562690258026 }, "Polygon": [{ "X": 0.009432097896933556, "Y": 0.01588769070804119 }, { "X": 0.05183364450931549, "Y": 0.015392506495118141 }, { "X": 0.05217165872454643, "Y": 0.13135719299316406 }, { "X": 0.009761521592736244, "Y": 0.13184379041194916 }] }, "Id": "357f0997-c79d-4c67-9aad-038fcca42fb1", "Relationships": [{ "Ids": ["ff59d2de-43bc-4dda-a50a-73854a6c29c2"], "Type": "CHILD" }], "Text": "University" }, { "BlockType": "LINE", "Confidence": 54.676185607910156, "Geometry": { "BoundingBox": { "Height": 0.006934878882020712, "Left": 0.051387954503297806, "Top": 0.043544042855501175, "Width": 0.008643150329589844 }, "Polygon": [{ "X": 0.051387954503297806, "Y": 0.043644316494464874 }, { "X": 0.060011085122823715, "Y": 0.043544042855501175 }, { "X": 0.06003110483288765, "Y": 0.05037875100970268 }, { "X": 0.05140786990523338, "Y": 0.050478920340538025 }] }, "Id": "93649026-87f0-4ad6-8290-9b0fc6c81ddd", "Relationships": [{ "Ids": ["f27268ca-6b3b-4486-9721-e5630f51f7f9"], "Type": "CHILD" }], "Text": "," }, { "BlockType": "LINE", "Confidence": 61.17164993286133, "Geometry": { "BoundingBox": { "Height": 0.08864781260490417, "Left": 0.18874236941337585, "Top": 0.026001514866948128, "Width": 0.5397365093231201 }, "Polygon": [{ "X": 0.18874236941337585, "Y": 0.03228325396776199 }, { "X": 0.7281414270401001, "Y": 0.026001514866948128 }, { "X": 0.7284789085388184, "Y": 0.1084451675415039 }, { "X": 0.18900208175182343, "Y": 0.11464933305978775 }] }, "Id": "88b1fba0-94b0-44ba-8fd4-4ef0c10e47b1", "Relationships": [{ "Ids": ["d1c6a89a-3c58-4b25-a9d6-ff6bb5747bdb"], "Type": "CHILD" }], "Text": "WRITETOPDF" }, { "BlockType": "LINE", "Confidence": 99.91246032714844, "Geometry": { "BoundingBox": { "Height": 0.026653127744793892, "Left": 0.22417715191841125, "Top": 0.13338296115398407, "Width": 0.08284486085176468 }, "Polygon": [{ "X": 0.22417715191841125, "Y": 0.13433177769184113 }, { "X": 0.3069356679916382, "Y": 0.13338296115398407 }, { "X": 0.30702200531959534, "Y": 0.15909099578857422 }, { "X": 0.22425977885723114, "Y": 0.1600360870361328 }] }, "Id": "7562a8ec-3c1b-4c2a-bace-58ae3e8f0d72", "Relationships": [{ "Ids": ["8dfb0030-6e82-4b32-b6bd-cd6c3feaab9c"], "Type": "CHILD" }], "Text": "Demo" }, { "BlockType": "LINE", "Confidence": 99.93730163574219, "Geometry": { "BoundingBox": { "Height": 0.028026098385453224, "Left": 0.6208364963531494, "Top": 0.130904421210289, "Width": 0.0979488417506218 }, "Polygon": [{ "X": 0.6208364963531494, "Y": 0.13202574849128723 }, { "X": 0.7186756730079651, "Y": 0.130904421210289 }, { "X": 0.7187853455543518, "Y": 0.15781378746032715 }, { "X": 0.6209415793418884, "Y": 0.15893052518367767 }] }, "Id": "ee0d74a5-7373-46bc-a348-0245e3624152", "Relationships": [{ "Ids": ["5a667ffb-f499-460f-9968-167aa4deb40c"], "Type": "CHILD" }], "Text": "Mark" }, { "BlockType": "LINE", "Confidence": 99.97679901123047, "Geometry": { "BoundingBox": { "Height": 0.027500081807374954, "Left": 0.3140467703342438, "Top": 0.16876958310604095, "Width": 0.02741697058081627 }, "Polygon": [{ "X": 0.3140467703342438, "Y": 0.16908112168312073 }, { "X": 0.3413707911968231, "Y": 0.16876958310604095 }, { "X": 0.34146374464035034, "Y": 0.1959594339132309 }, { "X": 0.31413841247558594, "Y": 0.1962696760892868 }] }, "Id": "261dbe58-2711-46b1-a1a2-d8d1f604b0a5", "Relationships": [{ "Ids": ["9339ff85-0d8e-4962-b312-937cf8f1600f"], "Type": "CHILD" }], "Text": "1" }, { "BlockType": "LINE", "Confidence": 70.59521484375, "Geometry": { "BoundingBox": { "Height": 0.028837502002716064, "Left": 0.6308741569519043, "Top": 0.1691037118434906, "Width": 0.08636639267206192 }, "Polygon": [{ "X": 0.6308741569519043, "Y": 0.17008642852306366 }, { "X": 0.7171270847320557, "Y": 0.1691037118434906 }, { "X": 0.7172405123710632, "Y": 0.19696266949176788 }, { "X": 0.6309834122657776, "Y": 0.19794121384620667 }] }, "Id": "c1283b92-f238-4e97-b5c8-b2ee29bad6ab", "Relationships": [{ "Ids": ["12f35692-d3fc-4ac4-93a9-6baa526e1db2"], "Type": "CHILD" }], "Text": "82.6" }, { "BlockType": "LINE", "Confidence": 29.59151840209961, "Geometry": { "BoundingBox": { "Height": 0.09989293664693832, "Left": 0.00491536408662796, "Top": 0.19013945758342743, "Width": 0.04675620049238205 }, "Polygon": [{ "X": 0.00491536408662796, "Y": 0.1906677782535553 }, { "X": 0.05138207972049713, "Y": 0.19013945758342743 }, { "X": 0.05167156457901001, "Y": 0.28951215744018555 }, { "X": 0.005196785554289818, "Y": 0.29003238677978516 }] }, "Id": "9ec22769-61b4-4f52-9fd5-740cb5fc4e1e", "Relationships": [{ "Ids": ["d85d3bba-cbe7-4f8a-bb3c-6455bc0b6d2f"], "Type": "CHILD" }], "Text": "Pribana" }, { "BlockType": "LINE", "Confidence": 99.87915802001953, "Geometry": { "BoundingBox": { "Height": 0.02149934321641922, "Left": 0.3151214122772217, "Top": 0.21337273716926575, "Width": 0.024512728676199913 }, "Polygon": [{ "X": 0.3151214122772217, "Y": 0.21364948153495789 }, { "X": 0.33956167101860046, "Y": 0.21337273716926575 }, { "X": 0.33963415026664734, "Y": 0.23459625244140625 }, { "X": 0.31519296765327454, "Y": 0.23487208783626556 }] }, "Id": "830e8b1f-ad06-49fd-94f5-f0da248775e3", "Relationships": [{ "Ids": ["ce2eab6a-794d-4c46-97f4-767c84c9224e"], "Type": "CHILD" }], "Text": "2" }, { "BlockType": "LINE", "Confidence": 80.5613784790039, "Geometry": { "BoundingBox": { "Height": 0.02638786844909191, "Left": 0.6272464990615845, "Top": 0.21147140860557556, "Width": 0.09417436271905899 }, "Polygon": [{ "X": 0.6272464990615845, "Y": 0.21253617107868195 }, { "X": 0.7213175296783447, "Y": 0.21147140860557556 }, { "X": 0.7214208841323853, "Y": 0.23679867386817932 }, { "X": 0.6273456811904907, "Y": 0.23785927891731262 }] }, "Id": "6062d954-1eec-496b-9eae-23d928af87b8", "Relationships": [{ "Ids": ["5c8c6ab1-ecfa-4310-9628-0db3adad9b4d"], "Type": "CHILD" }], "Text": "83.5" }, { "BlockType": "LINE", "Confidence": 99.9372329711914, "Geometry": { "BoundingBox": { "Height": 0.022683527320623398, "Left": 0.3131808936595917, "Top": 0.2541552484035492, "Width": 0.021250078454613686 }, "Polygon": [{ "X": 0.3131808936595917, "Y": 0.25439348816871643 }, { "X": 0.3343545198440552, "Y": 0.2541552484035492 }, { "X": 0.3344309628009796, "Y": 0.2766013741493225 }, { "X": 0.31325650215148926, "Y": 0.2768387794494629 }] }, "Id": "ac672918-1093-44b5-a490-9f7987b23106", "Relationships": [{ "Ids": ["afc87a3e-0e08-4db3-9fa0-a11b05c77cfc"], "Type": "CHILD" }], "Text": "3" }, { "BlockType": "LINE", "Confidence": 82.84917449951172, "Geometry": { "BoundingBox": { "Height": 0.02972184121608734, "Left": 0.6288750171661377, "Top": 0.24797523021697998, "Width": 0.09757307916879654 }, "Polygon": [{ "X": 0.6288750171661377, "Y": 0.24907201528549194 }, { "X": 0.7263310551643372, "Y": 0.24797523021697998 }, { "X": 0.726448118686676, "Y": 0.27660515904426575 }, { "X": 0.628987193107605, "Y": 0.2776970863342285 }] }, "Id": "4c68da93-b090-4d77-9f89-f602c86b0262", "Relationships": [{ "Ids": ["49d3a721-e94c-4a23-96b2-148632b8dd5d"], "Type": "CHILD" }], "Text": "99.9" }, { "BlockType": "LINE", "Confidence": 99.98025512695312, "Geometry": { "BoundingBox": { "Height": 0.02675747498869896, "Left": 0.31391823291778564, "Top": 0.29780468344688416, "Width": 0.020375341176986694 }, "Polygon": [{ "X": 0.31391823291778564, "Y": 0.2980313301086426 }, { "X": 0.33420324325561523, "Y": 0.29780468344688416 }, { "X": 0.33429357409477234, "Y": 0.3243364095687866 }, { "X": 0.31400763988494873, "Y": 0.3245621621608734 }] }, "Id": "3eb17212-add5-4175-89dd-52acfeed024f", "Relationships": [{ "Ids": ["2e6cd880-1459-4ac5-86a1-07313764a388"], "Type": "CHILD" }], "Text": "4" }, { "BlockType": "LINE", "Confidence": 94.01703643798828, "Geometry": { "BoundingBox": { "Height": 0.028284071013331413, "Left": 0.6268056035041809, "Top": 0.29591038823127747, "Width": 0.10603802651166916 }, "Polygon": [{ "X": 0.6268056035041809, "Y": 0.29709354043006897 }, { "X": 0.7327325344085693, "Y": 0.29591038823127747 }, { "X": 0.7328436374664307, "Y": 0.32301634550094604 }, { "X": 0.6269116997718811, "Y": 0.32419446110725403 }] }, "Id": "9c02f9d6-9048-4a0e-a8b8-5a1bb268f8c6", "Relationships": [{ "Ids": ["43549457-e6e4-4325-b323-75cf787a3eea"], "Type": "CHILD" }], "Text": "100.0" }, { "BlockType": "LINE", "Confidence": 99.71001434326172, "Geometry": { "BoundingBox": { "Height": 0.05815839394927025, "Left": 0.10259640216827393, "Top": 0.3524937927722931, "Width": 0.7238356471061707 }, "Polygon": [{ "X": 0.10259640216827393, "Y": 0.360502690076828 }, { "X": 0.8262180685997009, "Y": 0.3524937927722931 }, { "X": 0.8264320492744446, "Y": 0.40270668268203735 }, { "X": 0.10274691879749298, "Y": 0.41065219044685364 }] }, "Id": "41f4eae9-9c7b-4237-9244-35241b8ed71e", "Relationships": [{ "Ids": ["f8938211-da7f-4750-a64c-c7f89e4dd8b2", "e319ef9d-9ef4-4417-b3a2-cb82a0b64cd9", "56aaecc8-f6f6-48b4-87c3-44eb8dbdbd3e", "adc5f3ec-1b7a-44e2-9206-27c28cfee04b", "be515146-e7bd-498f-9924-7b836cb91cb6", "16d864fd-d8ed-463e-b674-ad9770224f9a"], "Type": "CHILD" }], "Text": "A document created for the progressive" }, { "BlockType": "LINE", "Confidence": 75.14616394042969, "Geometry": { "BoundingBox": { "Height": 0.05467575788497925, "Left": 0.10439636558294296, "Top": 0.39584362506866455, "Width": 0.5715765953063965 }, "Polygon": [{ "X": 0.10439636558294296, "Y": 0.4021255671977997 }, { "X": 0.6757792830467224, "Y": 0.39584362506866455 }, { "X": 0.6759729981422424, "Y": 0.4442858099937439 }, { "X": 0.10454176366329193, "Y": 0.4505193829536438 }] }, "Id": "4dcb9f58-fbd3-4aec-a9b2-59589bda2aa9", "Relationships": [{ "Ids": ["b3dc9c3c-fd19-4e81-8756-96dab3b2c5ed", "a036ac0f-d920-4bed-9256-4829851ba539", "818d58a4-8c6c-4048-8e78-f58390a78bd1"], "Type": "CHILD" }], "Text": "web application, write ToPdf" }, { "BlockType": "LINE", "Confidence": 23.177583694458008, "Geometry": { "BoundingBox": { "Height": 0.08876436203718185, "Left": 0.9111870527267456, "Top": 0.39849579334259033, "Width": 0.040814924985170364 }, "Polygon": [{ "X": 0.9111870527267456, "Y": 0.3989397883415222 }, { "X": 0.9516063332557678, "Y": 0.39849579334259033 }, { "X": 0.9520019292831421, "Y": 0.4868224263191223 }, { "X": 0.9115764498710632, "Y": 0.4872601628303528 }] }, "Id": "97d18cfc-a11a-4bd7-8a81-c7829deb202b", "Relationships": [{ "Ids": ["c2b56519-4a7d-4246-948e-8df0e5ac39d6"], "Type": "CHILD" }], "Text": "AMAZEN" }, { "BlockType": "LINE", "Confidence": 98.48632049560547, "Geometry": { "BoundingBox": { "Height": 0.05278646573424339, "Left": 0.2688049376010895, "Top": 0.48226261138916016, "Width": 0.23851625621318817 }, "Polygon": [{ "X": 0.2688049376010895, "Y": 0.4848472774028778 }, { "X": 0.5071350932121277, "Y": 0.48226261138916016 }, { "X": 0.5073211789131165, "Y": 0.53248530626297 }, { "X": 0.2689701020717621, "Y": 0.5350490808486938 }] }, "Id": "f23d4390-20ed-4834-918c-d7aecea969f2", "Relationships": [{ "Ids": ["bfa63c80-9461-4072-ab0f-4c49e82e9e09", "d852b7f3-d77e-4b18-b0c3-ac10355bed59"], "Type": "CHILD" }], "Text": "Janco Spies" }, { "BlockType": "LINE", "Confidence": 82.30896759033203, "Geometry": { "BoundingBox": { "Height": 0.052498601377010345, "Left": 0.9113295078277588, "Top": 0.5000706911087036, "Width": 0.044444117695093155 }, "Polygon": [{ "X": 0.9113295078277588, "Y": 0.5005483627319336 }, { "X": 0.9555402994155884, "Y": 0.5000706911087036 }, { "X": 0.955773651599884, "Y": 0.5520955920219421 }, { "X": 0.9115588665008545, "Y": 0.5525692701339722 }] }, "Id": "657d0005-4492-4a07-b853-6a319fc3c394", "Relationships": [{ "Ids": ["c74053da-c815-40df-af1a-26a525d64cb6"], "Type": "CHILD" }], "Text": "Web" }, { "BlockType": "LINE", "Confidence": 94.64369201660156, "Geometry": { "BoundingBox": { "Height": 0.08452358841896057, "Left": 0.06668096780776978, "Top": 0.5984454154968262, "Width": 0.7479478716850281 }, "Polygon": [{ "X": 0.06668096780776978, "Y": 0.6063957214355469 }, { "X": 0.8143038153648376, "Y": 0.5984454154968262 }, { "X": 0.8146288394927979, "Y": 0.6751188039779663 }, { "X": 0.0669059157371521, "Y": 0.6829689741134644 }] }, "Id": "06ae3aac-7a1e-4d39-aa55-661f0acb2f1c", "Relationships": [{ "Ids": ["ee851b3d-dddb-4df1-a170-5c3a54170af2", "db976a4e-9f79-4dfd-aac2-e4315acc2dc0", "b420729f-309e-481b-8530-d591382ca264", "52b4f6df-fb5b-434e-af66-07a12e552db2"], "Type": "CHILD" }], "Text": "Julian Pienaar Dylan kapnias" }, { "BlockType": "LINE", "Confidence": 53.129940032958984, "Geometry": { "BoundingBox": { "Height": 0.09345320612192154, "Left": 0.9068657159805298, "Top": 0.5629404187202454, "Width": 0.04885132983326912 }, "Polygon": [{ "X": 0.9068657159805298, "Y": 0.5634583830833435 }, { "X": 0.9553002715110779, "Y": 0.5629404187202454 }, { "X": 0.9557170867919922, "Y": 0.6558835506439209 }, { "X": 0.9072746634483337, "Y": 0.6563936471939087 }] }, "Id": "925c6296-219e-4ae1-80d9-e759e21b86f5", "Relationships": [{ "Ids": ["83693ebe-0bb3-4c6b-b509-4517bb57e809"], "Type": "CHILD" }], "Text": "Services" }, { "BlockType": "LINE", "Confidence": 74.15707397460938, "Geometry": { "BoundingBox": { "Height": 0.08312303572893143, "Left": 0.10653604567050934, "Top": 0.7432528734207153, "Width": 0.12596304714679718 }, "Polygon": [{ "X": 0.10653604567050934, "Y": 0.7445587515830994 }, { "X": 0.23223517835140228, "Y": 0.7432528734207153 }, { "X": 0.23249909281730652, "Y": 0.8250879645347595 }, { "X": 0.10678201168775558, "Y": 0.8263759016990662 }] }, "Id": "eee9c1b6-0acc-4ba1-8569-c3b817d1b19f", "Relationships": [{ "Ids": ["ab44b7b8-4c0c-4abf-b621-18994dd226a1"], "Type": "CHILD" }], "Text": "Take" }, { "BlockType": "LINE", "Confidence": 88.49658966064453, "Geometry": { "BoundingBox": { "Height": 0.046857889741659164, "Left": 0.47488781809806824, "Top": 0.7312363982200623, "Width": 0.38545694947242737 }, "Polygon": [{ "X": 0.47488781809806824, "Y": 0.7352428436279297 }, { "X": 0.8601595759391785, "Y": 0.7312363982200623 }, { "X": 0.8603447675704956, "Y": 0.7741166949272156 }, { "X": 0.4750441014766693, "Y": 0.7780942916870117 }] }, "Id": "a34f8ac7-9821-49c6-9718-fcfadc203bfb", "Relationships": [{ "Ids": ["6af874d8-bd93-46df-b133-2ff15ab4147d", "1afe83d3-cd46-4294-9db2-2136964d0794"], "Type": "CHILD" }], "Text": "Convad Strasheim" }, { "BlockType": "LINE", "Confidence": 90.93990325927734, "Geometry": { "BoundingBox": { "Height": 0.04873444885015488, "Left": 0.6528065800666809, "Top": 0.9368531107902527, "Width": 0.22179435193538666 }, "Polygon": [{ "X": 0.6528065800666809, "Y": 0.9390770196914673 }, { "X": 0.874398946762085, "Y": 0.9368531107902527 }, { "X": 0.8746009469032288, "Y": 0.9833816289901733 }, { "X": 0.6529905796051025, "Y": 0.9855875372886658 }] }, "Id": "bee23dd9-6d10-4558-9b85-a9dc20f59355", "Relationships": [{ "Ids": ["f78cd180-53ae-4327-924e-b044db333e6e"], "Type": "CHILD" }], "Text": "@xParadigm" }, { "BlockType": "WORD", "Confidence": 85.21019744873047, "Geometry": { "BoundingBox": { "Height": 0.11645128577947617, "Left": 0.009432097896933556, "Top": 0.015392506495118141, "Width": 0.042739562690258026 }, "Polygon": [{ "X": 0.009432097896933556, "Y": 0.01588769070804119 }, { "X": 0.05183364450931549, "Y": 0.015392506495118141 }, { "X": 0.05217165872454643, "Y": 0.13135719299316406 }, { "X": 0.009761521592736244, "Y": 0.13184379041194916 }] }, "Id": "ff59d2de-43bc-4dda-a50a-73854a6c29c2", "Text": "University", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 54.676185607910156, "Geometry": { "BoundingBox": { "Height": 0.006934878882020712, "Left": 0.051387954503297806, "Top": 0.043544042855501175, "Width": 0.008643150329589844 }, "Polygon": [{ "X": 0.051387954503297806, "Y": 0.043644316494464874 }, { "X": 0.060011085122823715, "Y": 0.043544042855501175 }, { "X": 0.06003110483288765, "Y": 0.05037875100970268 }, { "X": 0.05140786990523338, "Y": 0.050478920340538025 }] }, "Id": "f27268ca-6b3b-4486-9721-e5630f51f7f9", "Text": ",", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 61.17164993286133, "Geometry": { "BoundingBox": { "Height": 0.08864781260490417, "Left": 0.18874236941337585, "Top": 0.026001514866948128, "Width": 0.5397365093231201 }, "Polygon": [{ "X": 0.18874236941337585, "Y": 0.03228325396776199 }, { "X": 0.7281414270401001, "Y": 0.026001514866948128 }, { "X": 0.7284789085388184, "Y": 0.1084451675415039 }, { "X": 0.18900208175182343, "Y": 0.11464933305978775 }] }, "Id": "d1c6a89a-3c58-4b25-a9d6-ff6bb5747bdb", "Text": "WRITETOPDF", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.91246032714844, "Geometry": { "BoundingBox": { "Height": 0.026653127744793892, "Left": 0.22417715191841125, "Top": 0.13338296115398407, "Width": 0.08284486085176468 }, "Polygon": [{ "X": 0.22417715191841125, "Y": 0.13433177769184113 }, { "X": 0.3069356679916382, "Y": 0.13338296115398407 }, { "X": 0.30702200531959534, "Y": 0.15909099578857422 }, { "X": 0.22425977885723114, "Y": 0.1600360870361328 }] }, "Id": "8dfb0030-6e82-4b32-b6bd-cd6c3feaab9c", "Text": "Demo", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.93730163574219, "Geometry": { "BoundingBox": { "Height": 0.028026098385453224, "Left": 0.6208364963531494, "Top": 0.130904421210289, "Width": 0.0979488417506218 }, "Polygon": [{ "X": 0.6208364963531494, "Y": 0.13202574849128723 }, { "X": 0.7186756730079651, "Y": 0.130904421210289 }, { "X": 0.7187853455543518, "Y": 0.15781378746032715 }, { "X": 0.6209415793418884, "Y": 0.15893052518367767 }] }, "Id": "5a667ffb-f499-460f-9968-167aa4deb40c", "Text": "Mark", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.97679901123047, "Geometry": { "BoundingBox": { "Height": 0.027500081807374954, "Left": 0.3140467703342438, "Top": 0.16876958310604095, "Width": 0.02741697058081627 }, "Polygon": [{ "X": 0.3140467703342438, "Y": 0.16908112168312073 }, { "X": 0.3413707911968231, "Y": 0.16876958310604095 }, { "X": 0.34146374464035034, "Y": 0.1959594339132309 }, { "X": 0.31413841247558594, "Y": 0.1962696760892868 }] }, "Id": "9339ff85-0d8e-4962-b312-937cf8f1600f", "Text": "1", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 70.59521484375, "Geometry": { "BoundingBox": { "Height": 0.028837502002716064, "Left": 0.6308741569519043, "Top": 0.1691037118434906, "Width": 0.08636639267206192 }, "Polygon": [{ "X": 0.6308741569519043, "Y": 0.17008642852306366 }, { "X": 0.7171270847320557, "Y": 0.1691037118434906 }, { "X": 0.7172405123710632, "Y": 0.19696266949176788 }, { "X": 0.6309834122657776, "Y": 0.19794121384620667 }] }, "Id": "12f35692-d3fc-4ac4-93a9-6baa526e1db2", "Text": "82.6", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 29.59151840209961, "Geometry": { "BoundingBox": { "Height": 0.09989293664693832, "Left": 0.00491536408662796, "Top": 0.19013945758342743, "Width": 0.04675620049238205 }, "Polygon": [{ "X": 0.00491536408662796, "Y": 0.1906677782535553 }, { "X": 0.05138207972049713, "Y": 0.19013945758342743 }, { "X": 0.05167156457901001, "Y": 0.28951215744018555 }, { "X": 0.005196785554289818, "Y": 0.29003238677978516 }] }, "Id": "d85d3bba-cbe7-4f8a-bb3c-6455bc0b6d2f", "Text": "Pribana", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.87915802001953, "Geometry": { "BoundingBox": { "Height": 0.02149934321641922, "Left": 0.3151214122772217, "Top": 0.21337273716926575, "Width": 0.024512728676199913 }, "Polygon": [{ "X": 0.3151214122772217, "Y": 0.21364948153495789 }, { "X": 0.33956167101860046, "Y": 0.21337273716926575 }, { "X": 0.33963415026664734, "Y": 0.23459625244140625 }, { "X": 0.31519296765327454, "Y": 0.23487208783626556 }] }, "Id": "ce2eab6a-794d-4c46-97f4-767c84c9224e", "Text": "2", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 80.5613784790039, "Geometry": { "BoundingBox": { "Height": 0.02638786844909191, "Left": 0.6272464990615845, "Top": 0.21147140860557556, "Width": 0.09417436271905899 }, "Polygon": [{ "X": 0.6272464990615845, "Y": 0.21253617107868195 }, { "X": 0.7213175296783447, "Y": 0.21147140860557556 }, { "X": 0.7214208841323853, "Y": 0.23679867386817932 }, { "X": 0.6273456811904907, "Y": 0.23785927891731262 }] }, "Id": "5c8c6ab1-ecfa-4310-9628-0db3adad9b4d", "Text": "83.5", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.9372329711914, "Geometry": { "BoundingBox": { "Height": 0.022683527320623398, "Left": 0.3131808936595917, "Top": 0.2541552484035492, "Width": 0.021250078454613686 }, "Polygon": [{ "X": 0.3131808936595917, "Y": 0.25439348816871643 }, { "X": 0.3343545198440552, "Y": 0.2541552484035492 }, { "X": 0.3344309628009796, "Y": 0.2766013741493225 }, { "X": 0.31325650215148926, "Y": 0.2768387794494629 }] }, "Id": "afc87a3e-0e08-4db3-9fa0-a11b05c77cfc", "Text": "3", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 82.84917449951172, "Geometry": { "BoundingBox": { "Height": 0.02972184121608734, "Left": 0.6288750171661377, "Top": 0.24797523021697998, "Width": 0.09757307916879654 }, "Polygon": [{ "X": 0.6288750171661377, "Y": 0.24907201528549194 }, { "X": 0.7263310551643372, "Y": 0.24797523021697998 }, { "X": 0.726448118686676, "Y": 0.27660515904426575 }, { "X": 0.628987193107605, "Y": 0.2776970863342285 }] }, "Id": "49d3a721-e94c-4a23-96b2-148632b8dd5d", "Text": "99.9", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.98025512695312, "Geometry": { "BoundingBox": { "Height": 0.02675747498869896, "Left": 0.31391823291778564, "Top": 0.29780468344688416, "Width": 0.020375341176986694 }, "Polygon": [{ "X": 0.31391823291778564, "Y": 0.2980313301086426 }, { "X": 0.33420324325561523, "Y": 0.29780468344688416 }, { "X": 0.33429357409477234, "Y": 0.3243364095687866 }, { "X": 0.31400763988494873, "Y": 0.3245621621608734 }] }, "Id": "2e6cd880-1459-4ac5-86a1-07313764a388", "Text": "4", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 94.01703643798828, "Geometry": { "BoundingBox": { "Height": 0.028284071013331413, "Left": 0.6268056035041809, "Top": 0.29591038823127747, "Width": 0.10603802651166916 }, "Polygon": [{ "X": 0.6268056035041809, "Y": 0.29709354043006897 }, { "X": 0.7327325344085693, "Y": 0.29591038823127747 }, { "X": 0.7328436374664307, "Y": 0.32301634550094604 }, { "X": 0.6269116997718811, "Y": 0.32419446110725403 }] }, "Id": "43549457-e6e4-4325-b323-75cf787a3eea", "Text": "100.0", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.9935073852539, "Geometry": { "BoundingBox": { "Height": 0.0284106582403183, "Left": 0.10261062532663345, "Top": 0.3649454712867737, "Width": 0.026910554617643356 }, "Polygon": [{ "X": 0.10261062532663345, "Y": 0.3652421236038208 }, { "X": 0.1294354796409607, "Y": 0.3649454712867737 }, { "X": 0.1295211762189865, "Y": 0.3930607736110687 }, { "X": 0.10269501060247421, "Y": 0.3933561146259308 }] }, "Id": "f8938211-da7f-4750-a64c-c7f89e4dd8b2", "Text": "A", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.97647857666016, "Geometry": { "BoundingBox": { "Height": 0.02888198010623455, "Left": 0.15269100666046143, "Top": 0.3633699417114258, "Width": 0.15826840698719025 }, "Polygon": [{ "X": 0.15269100666046143, "Y": 0.36511915922164917 }, { "X": 0.31086811423301697, "Y": 0.3633699417114258 }, { "X": 0.31095942854881287, "Y": 0.3905102014541626 }, { "X": 0.15277481079101562, "Y": 0.3922519087791443 }] }, "Id": "e319ef9d-9ef4-4417-b3a2-cb82a0b64cd9", "Text": "document", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.55386352539062, "Geometry": { "BoundingBox": { "Height": 0.02671433612704277, "Left": 0.3338850438594818, "Top": 0.36416786909103394, "Width": 0.13523416221141815 }, "Polygon": [{ "X": 0.3338850438594818, "Y": 0.36566174030303955 }, { "X": 0.46902740001678467, "Y": 0.36416786909103394 }, { "X": 0.46911922097206116, "Y": 0.38939425349235535 }, { "X": 0.33397090435028076, "Y": 0.3908821940422058 }] }, "Id": "56aaecc8-f6f6-48b4-87c3-44eb8dbdbd3e", "Text": "created", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.98411560058594, "Geometry": { "BoundingBox": { "Height": 0.032070666551589966, "Left": 0.48930755257606506, "Top": 0.3558838963508606, "Width": 0.04638518765568733 }, "Polygon": [{ "X": 0.48930755257606506, "Y": 0.3563959300518036 }, { "X": 0.535574197769165, "Y": 0.3558838963508606 }, { "X": 0.5356927514076233, "Y": 0.38744503259658813 }, { "X": 0.4894235134124756, "Y": 0.38795456290245056 }] }, "Id": "adc5f3ec-1b7a-44e2-9206-27c28cfee04b", "Text": "for", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.98944091796875, "Geometry": { "BoundingBox": { "Height": 0.02795892022550106, "Left": 0.5564494729042053, "Top": 0.3623191714286804, "Width": 0.0623181089758873 }, "Polygon": [{ "X": 0.5564494729042053, "Y": 0.3630068898200989 }, { "X": 0.6186611652374268, "Y": 0.3623191714286804 }, { "X": 0.6187675595283508, "Y": 0.38959333300590515 }, { "X": 0.5565528273582458, "Y": 0.39027807116508484 }] }, "Id": "be515146-e7bd-498f-9924-7b836cb91cb6", "Text": "the", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 98.76263427734375, "Geometry": { "BoundingBox": { "Height": 0.05226193740963936, "Left": 0.6396062970161438, "Top": 0.3524937927722931, "Width": 0.18682575225830078 }, "Polygon": [{ "X": 0.6396062970161438, "Y": 0.35455915331840515 }, { "X": 0.8262180685997009, "Y": 0.3524937927722931 }, { "X": 0.8264320492744446, "Y": 0.40270668268203735 }, { "X": 0.639803946018219, "Y": 0.40475571155548096 }] }, "Id": "16d864fd-d8ed-463e-b674-ad9770224f9a", "Text": "progressive", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.90597534179688, "Geometry": { "BoundingBox": { "Height": 0.030750863254070282, "Left": 0.10441629588603973, "Top": 0.4079669713973999, "Width": 0.07217779755592346 }, "Polygon": [{ "X": 0.10441629588603973, "Y": 0.40875864028930664 }, { "X": 0.17650030553340912, "Y": 0.4079669713973999 }, { "X": 0.1765940934419632, "Y": 0.4379299581050873 }, { "X": 0.10450630635023117, "Y": 0.4387178421020508 }] }, "Id": "b3dc9c3c-fd19-4e81-8756-96dab3b2c5ed", "Text": "web", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 88.74806213378906, "Geometry": { "BoundingBox": { "Height": 0.04823294281959534, "Left": 0.2028757631778717, "Top": 0.4012121558189392, "Width": 0.21119163930416107 }, "Polygon": [{ "X": 0.2028757631778717, "Y": 0.40353134274482727 }, { "X": 0.41390466690063477, "Y": 0.4012121558189392 }, { "X": 0.41406741738319397, "Y": 0.4471428692340851 }, { "X": 0.2030215859413147, "Y": 0.44944509863853455 }] }, "Id": "a036ac0f-d920-4bed-9256-4829851ba539", "Text": "application,", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 36.784454345703125, "Geometry": { "BoundingBox": { "Height": 0.037422459572553635, "Left": 0.434703528881073, "Top": 0.39584362506866455, "Width": 0.24121485650539398 }, "Polygon": [{ "X": 0.434703528881073, "Y": 0.39849409461021423 }, { "X": 0.6757792830467224, "Y": 0.39584362506866455 }, { "X": 0.6759184002876282, "Y": 0.43063029646873474 }, { "X": 0.434827983379364, "Y": 0.4332661032676697 }] }, "Id": "818d58a4-8c6c-4048-8e78-f58390a78bd1", "Text": "write ToPdf", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 23.177583694458008, "Geometry": { "BoundingBox": { "Height": 0.08876436203718185, "Left": 0.9111870527267456, "Top": 0.39849579334259033, "Width": 0.040814924985170364 }, "Polygon": [{ "X": 0.9111870527267456, "Y": 0.3989397883415222 }, { "X": 0.9516063332557678, "Y": 0.39849579334259033 }, { "X": 0.9520019292831421, "Y": 0.4868224263191223 }, { "X": 0.9115764498710632, "Y": 0.4872601628303528 }] }, "Id": "c2b56519-4a7d-4246-948e-8df0e5ac39d6", "Text": "AMAZEN", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 97.4811019897461, "Geometry": { "BoundingBox": { "Height": 0.04186122119426727, "Left": 0.2688049376010895, "Top": 0.4837382733821869, "Width": 0.10240350663661957 }, "Polygon": [{ "X": 0.2688049376010895, "Y": 0.4848472774028778 }, { "X": 0.3710671067237854, "Y": 0.4837382733821869 }, { "X": 0.37120845913887024, "Y": 0.5244977474212646 }, { "X": 0.2689390182495117, "Y": 0.525599479675293 }] }, "Id": "bfa63c80-9461-4072-ab0f-4c49e82e9e09", "Text": "Janco", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.49153900146484, "Geometry": { "BoundingBox": { "Height": 0.049535516649484634, "Left": 0.4068633019924164, "Top": 0.48402848839759827, "Width": 0.10045789182186127 }, "Polygon": [{ "X": 0.4068633019924164, "Y": 0.4851157069206238 }, { "X": 0.507141649723053, "Y": 0.48402848839759827 }, { "X": 0.5073211789131165, "Y": 0.53248530626297 }, { "X": 0.40703433752059937, "Y": 0.533564031124115 }] }, "Id": "d852b7f3-d77e-4b18-b0c3-ac10355bed59", "Text": "Spies", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 82.30896759033203, "Geometry": { "BoundingBox": { "Height": 0.052498601377010345, "Left": 0.9113295078277588, "Top": 0.5000706911087036, "Width": 0.044444117695093155 }, "Polygon": [{ "X": 0.9113295078277588, "Y": 0.5005483627319336 }, { "X": 0.9555402994155884, "Y": 0.5000706911087036 }, { "X": 0.955773651599884, "Y": 0.5520955920219421 }, { "X": 0.9115588665008545, "Y": 0.5525692701339722 }] }, "Id": "c74053da-c815-40df-af1a-26a525d64cb6", "Text": "Web", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.8996353149414, "Geometry": { "BoundingBox": { "Height": 0.04747640714049339, "Left": 0.06671909987926483, "Top": 0.6178238391876221, "Width": 0.14635556936264038 }, "Polygon": [{ "X": 0.06671909987926483, "Y": 0.6193752884864807 }, { "X": 0.21292802691459656, "Y": 0.6178238391876221 }, { "X": 0.2130746692419052, "Y": 0.6637605428695679 }, { "X": 0.06685400754213333, "Y": 0.6653002500534058 }] }, "Id": "ee851b3d-dddb-4df1-a170-5c3a54170af2", "Text": "Julian", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.37928009033203, "Geometry": { "BoundingBox": { "Height": 0.0471467524766922, "Left": 0.24197107553482056, "Top": 0.610829770565033, "Width": 0.13605216145515442 }, "Polygon": [{ "X": 0.24197107553482056, "Y": 0.6122730374336243 }, { "X": 0.37786418199539185, "Y": 0.610829770565033 }, { "X": 0.378023236989975, "Y": 0.6565441489219666 }, { "X": 0.24211928248405457, "Y": 0.6579765677452087 }] }, "Id": "db976a4e-9f79-4dfd-aac2-e4315acc2dc0", "Text": "Pienaar", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 99.24591064453125, "Geometry": { "BoundingBox": { "Height": 0.07080363482236862, "Left": 0.470345675945282, "Top": 0.6079270839691162, "Width": 0.12615281343460083 }, "Polygon": [{ "X": 0.470345675945282, "Y": 0.6092641353607178 }, { "X": 0.5962303280830383, "Y": 0.6079270839691162 }, { "X": 0.5964984893798828, "Y": 0.6774088740348816 }, { "X": 0.4705985188484192, "Y": 0.6787307262420654 }] }, "Id": "b420729f-309e-481b-8530-d591382ca264", "Text": "Dylan", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 80.04994201660156, "Geometry": { "BoundingBox": { "Height": 0.06689740717411041, "Left": 0.6346489787101746, "Top": 0.5984454154968262, "Width": 0.1799304038286209 }, "Polygon": [{ "X": 0.6346489787101746, "Y": 0.600355863571167 }, { "X": 0.8143038153648376, "Y": 0.5984454154968262 }, { "X": 0.8145793676376343, "Y": 0.6634527444839478 }, { "X": 0.634904146194458, "Y": 0.6653428077697754 }] }, "Id": "52b4f6df-fb5b-434e-af66-07a12e552db2", "Text": "kapnias", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 53.129940032958984, "Geometry": { "BoundingBox": { "Height": 0.09345320612192154, "Left": 0.9068657159805298, "Top": 0.5629404187202454, "Width": 0.04885132983326912 }, "Polygon": [{ "X": 0.9068657159805298, "Y": 0.5634583830833435 }, { "X": 0.9553002715110779, "Y": 0.5629404187202454 }, { "X": 0.9557170867919922, "Y": 0.6558835506439209 }, { "X": 0.9072746634483337, "Y": 0.6563936471939087 }] }, "Id": "83693ebe-0bb3-4c6b-b509-4517bb57e809", "Text": "Services", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 74.15707397460938, "Geometry": { "BoundingBox": { "Height": 0.08312303572893143, "Left": 0.10653604567050934, "Top": 0.7432528734207153, "Width": 0.12596304714679718 }, "Polygon": [{ "X": 0.10653604567050934, "Y": 0.7445587515830994 }, { "X": 0.23223517835140228, "Y": 0.7432528734207153 }, { "X": 0.23249909281730652, "Y": 0.8250879645347595 }, { "X": 0.10678201168775558, "Y": 0.8263759016990662 }] }, "Id": "ab44b7b8-4c0c-4abf-b621-18994dd226a1", "Text": "Take", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 79.22528076171875, "Geometry": { "BoundingBox": { "Height": 0.04247720539569855, "Left": 0.47488781809806824, "Top": 0.7338534593582153, "Width": 0.1337684988975525 }, "Polygon": [{ "X": 0.47488781809806824, "Y": 0.7352428436279297 }, { "X": 0.6084968447685242, "Y": 0.7338534593582153 }, { "X": 0.6086562871932983, "Y": 0.7749508619308472 }, { "X": 0.47503766417503357, "Y": 0.7763306498527527 }] }, "Id": "6af874d8-bd93-46df-b133-2ff15ab4147d", "Text": "Convad", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 97.76789855957031, "Geometry": { "BoundingBox": { "Height": 0.04359515383839607, "Left": 0.6444106698036194, "Top": 0.7327490448951721, "Width": 0.21593408286571503 }, "Polygon": [{ "X": 0.6444106698036194, "Y": 0.7349920868873596 }, { "X": 0.8601661324501038, "Y": 0.7327490448951721 }, { "X": 0.8603447675704956, "Y": 0.7741166949272156 }, { "X": 0.6445736885070801, "Y": 0.7763441801071167 }] }, "Id": "1afe83d3-cd46-4294-9db2-2136964d0794", "Text": "Strasheim", "TextType": "HANDWRITING" }, { "BlockType": "WORD", "Confidence": 90.93990325927734, "Geometry": { "BoundingBox": { "Height": 0.04873444885015488, "Left": 0.6528065800666809, "Top": 0.9368531107902527, "Width": 0.22179435193538666 }, "Polygon": [{ "X": 0.6528065800666809, "Y": 0.9390770196914673 }, { "X": 0.874398946762085, "Y": 0.9368531107902527 }, { "X": 0.8746009469032288, "Y": 0.9833816289901733 }, { "X": 0.6529905796051025, "Y": 0.9855875372886658 }] }, "Id": "f78cd180-53ae-4327-924e-b044db333e6e", "Text": "@xParadigm", "TextType": "HANDWRITING" }, { "BlockType": "TABLE", "Confidence": 99.853515625, "EntityTypes": ["STRUCTURED_TABLE"], "Geometry": { "BoundingBox": { "Height": 0.2083776742219925, "Left": 0.15134431421756744, "Top": 0.12716637551784515, "Width": 0.7061780691146851 }, "Polygon": [{ "X": 0.15134431421756744, "Y": 0.13525258004665375 }, { "X": 0.8566568493843079, "Y": 0.12716637551784515 }, { "X": 0.8575224280357361, "Y": 0.32770463824272156 }, { "X": 0.15196272730827332, "Y": 0.33554404973983765 }] }, "Id": "d569d7e8-8563-403e-a860-b86e2e7face3", "Relationships": [{ "Ids": ["a736f249-44b6-42a4-96f6-a4e65bb394ad", "37edc78e-a9a5-499f-8ec4-1f2c76130fb0", "23e25e9b-29b0-4436-8474-1a3114fe9fd1", "c8afe585-e4f1-4116-a49d-aec3c78885c9", "05e20f4c-d6b1-4bab-bfe2-a21819602e01", "c99adb82-f172-41a4-b092-0acd75d775e3", "d03c0a23-c8ee-4944-8871-07968bab5cb2", "bb1c90b8-b7e0-4fa2-b17f-bd689dc34640", "6f965300-75df-419f-a91a-0c943afb705a", "ceddb283-d985-4ee5-88f4-e6698cfbaef3"], "Type": "CHILD" }] }, { "BlockType": "CELL", "ColumnIndex": 1, "ColumnSpan": 1, "Confidence": 93.359375, "EntityTypes": ["COLUMN_HEADER"], "Geometry": { "BoundingBox": { "Height": 0.03521519899368286, "Left": 0.15134431421756744, "Top": 0.13120214641094208, "Width": 0.3534114956855774 }, "Polygon": [{ "X": 0.15134431421756744, "Y": 0.13525258004665375 }, { "X": 0.5046403408050537, "Y": 0.13120214641094208 }, { "X": 0.5047557950019836, "Y": 0.16238613426685333 }, { "X": 0.15144053101539612, "Y": 0.16641734540462494 }] }, "Id": "a736f249-44b6-42a4-96f6-a4e65bb394ad", "Relationships": [{ "Ids": ["8dfb0030-6e82-4b32-b6bd-cd6c3feaab9c"], "Type": "CHILD" }], "RowIndex": 1, "RowSpan": 1 }, { "BlockType": "CELL", "ColumnIndex": 2, "ColumnSpan": 1, "Confidence": 93.5546875, "EntityTypes": ["COLUMN_HEADER"], "Geometry": { "BoundingBox": { "Height": 0.03521975874900818, "Left": 0.5046403408050537, "Top": 0.12716637551784515, "Width": 0.35215118527412415 }, "Polygon": [{ "X": 0.5046403408050537, "Y": 0.13120214641094208 }, { "X": 0.8566568493843079, "Y": 0.12716637551784515 }, { "X": 0.8567915558815002, "Y": 0.1583695411682129 }, { "X": 0.5047557950019836, "Y": 0.16238613426685333 }] }, "Id": "37edc78e-a9a5-499f-8ec4-1f2c76130fb0", "Relationships": [{ "Ids": ["5a667ffb-f499-460f-9968-167aa4deb40c"], "Type": "CHILD" }], "RowIndex": 1, "RowSpan": 1 }, { "BlockType": "CELL", "ColumnIndex": 1, "ColumnSpan": 1, "Confidence": 92.138671875, "Geometry": { "BoundingBox": { "Height": 0.046505652368068695, "Left": 0.15144053101539612, "Top": 0.16238613426685333, "Width": 0.35347265005111694 }, "Polygon": [{ "X": 0.15144053101539612, "Y": 0.16641734540462494 }, { "X": 0.5047557950019836, "Y": 0.16238613426685333 }, { "X": 0.5049132108688354, "Y": 0.204886794090271 }, { "X": 0.15157167613506317, "Y": 0.20889179408550262 }] }, "Id": "23e25e9b-29b0-4436-8474-1a3114fe9fd1", "Relationships": [{ "Ids": ["9339ff85-0d8e-4962-b312-937cf8f1600f"], "Type": "CHILD" }], "RowIndex": 2, "RowSpan": 1 }, { "BlockType": "CELL", "ColumnIndex": 2, "ColumnSpan": 1, "Confidence": 92.333984375, "Geometry": { "BoundingBox": { "Height": 0.0465172603726387, "Left": 0.5047557950019836, "Top": 0.1583695411682129, "Width": 0.35221928358078003 }, "Polygon": [{ "X": 0.5047557950019836, "Y": 0.16238613426685333 }, { "X": 0.8567915558815002, "Y": 0.1583695411682129 }, { "X": 0.8569750785827637, "Y": 0.20089630782604218 }, { "X": 0.5049132108688354, "Y": 0.204886794090271 }] }, "Id": "c8afe585-e4f1-4116-a49d-aec3c78885c9", "Relationships": [{ "Ids": ["12f35692-d3fc-4ac4-93a9-6baa526e1db2"], "Type": "CHILD" }], "RowIndex": 2, "RowSpan": 1 }, { "BlockType": "CELL", "ColumnIndex": 1, "ColumnSpan": 1, "Confidence": 89.84375, "Geometry": { "BoundingBox": { "Height": 0.04262357950210571, "Left": 0.15157167613506317, "Top": 0.204886794090271, "Width": 0.3534846007823944 }, "Polygon": [{ "X": 0.15157167613506317, "Y": 0.20889179408550262 }, { "X": 0.5049132108688354, "Y": 0.204886794090271 }, { "X": 0.5050562620162964, "Y": 0.24352921545505524 }, { "X": 0.15169091522693634, "Y": 0.2475103735923767 }] }, "Id": "05e20f4c-d6b1-4bab-bfe2-a21819602e01", "Relationships": [{ "Ids": ["ce2eab6a-794d-4c46-97f4-767c84c9224e"], "Type": "CHILD" }], "RowIndex": 3, "RowSpan": 1 }, { "BlockType": "CELL", "ColumnIndex": 2, "ColumnSpan": 1, "Confidence": 89.990234375, "Geometry": { "BoundingBox": { "Height": 0.04263291135430336, "Left": 0.5049132108688354, "Top": 0.20089630782604218, "Width": 0.3522287905216217 }, "Polygon": [{ "X": 0.5049132108688354, "Y": 0.204886794090271 }, { "X": 0.8569750785827637, "Y": 0.20089630782604218 }, { "X": 0.8571419715881348, "Y": 0.23956246674060822 }, { "X": 0.5050562620162964, "Y": 0.24352921545505524 }] }, "Id": "c99adb82-f172-41a4-b092-0acd75d775e3", "Relationships": [{ "Ids": ["5c8c6ab1-ecfa-4310-9628-0db3adad9b4d"], "Type": "CHILD" }], "RowIndex": 3, "RowSpan": 1 }, { "BlockType": "CELL", "ColumnIndex": 1, "ColumnSpan": 1, "Confidence": 87.353515625, "Geometry": { "BoundingBox": { "Height": 0.04812305048108101, "Left": 0.15169091522693634, "Top": 0.24352921545505524, "Width": 0.3535289168357849 }, "Polygon": [{ "X": 0.15169091522693634, "Y": 0.2475103735923767 }, { "X": 0.5050562620162964, "Y": 0.24352921545505524 }, { "X": 0.5052198171615601, "Y": 0.287698358297348 }, { "X": 0.15182720124721527, "Y": 0.29165226221084595 }] }, "Id": "d03c0a23-c8ee-4944-8871-07968bab5cb2", "Relationships": [{ "Ids": ["afc87a3e-0e08-4db3-9fa0-a11b05c77cfc"], "Type": "CHILD" }], "RowIndex": 4, "RowSpan": 1 }, { "BlockType": "CELL", "ColumnIndex": 2, "ColumnSpan": 1, "Confidence": 87.548828125, "Geometry": { "BoundingBox": { "Height": 0.04813588038086891, "Left": 0.5050562620162964, "Top": 0.23956246674060822, "Width": 0.35227644443511963 }, "Polygon": [{ "X": 0.5050562620162964, "Y": 0.24352921545505524 }, { "X": 0.8571419715881348, "Y": 0.23956246674060822 }, { "X": 0.857332706451416, "Y": 0.2837587594985962 }, { "X": 0.5052198171615601, "Y": 0.287698358297348 }] }, "Id": "bb1c90b8-b7e0-4fa2-b17f-bd689dc34640", "Relationships": [{ "Ids": ["49d3a721-e94c-4a23-96b2-148632b8dd5d"], "Type": "CHILD" }], "RowIndex": 4, "RowSpan": 1 }, { "BlockType": "CELL", "ColumnIndex": 1, "ColumnSpan": 1, "Confidence": 90.72265625, "Geometry": { "BoundingBox": { "Height": 0.04784570634365082, "Left": 0.15182720124721527, "Top": 0.287698358297348, "Width": 0.35355526208877563 }, "Polygon": [{ "X": 0.15182720124721527, "Y": 0.29165226221084595 }, { "X": 0.5052198171615601, "Y": 0.287698358297348 }, { "X": 0.5053824782371521, "Y": 0.33161723613739014 }, { "X": 0.15196272730827332, "Y": 0.33554404973983765 }] }, "Id": "6f965300-75df-419f-a91a-0c943afb705a", "Relationships": [{ "Ids": ["2e6cd880-1459-4ac5-86a1-07313764a388"], "Type": "CHILD" }], "RowIndex": 5, "RowSpan": 1 }, { "BlockType": "CELL", "ColumnIndex": 2, "ColumnSpan": 1, "Confidence": 90.91796875, "Geometry": { "BoundingBox": { "Height": 0.04785848408937454, "Left": 0.5052198171615601, "Top": 0.2837587594985962, "Width": 0.35230258107185364 }, "Polygon": [{ "X": 0.5052198171615601, "Y": 0.287698358297348 }, { "X": 0.857332706451416, "Y": 0.2837587594985962 }, { "X": 0.8575224280357361, "Y": 0.32770463824272156 }, { "X": 0.5053824782371521, "Y": 0.33161723613739014 }] }, "Id": "ceddb283-d985-4ee5-88f4-e6698cfbaef3", "Relationships": [{ "Ids": ["43549457-e6e4-4325-b323-75cf787a3eea"], "Type": "CHILD" }], "RowIndex": 5, "RowSpan": 1 }], "DocumentMetadata": { "Pages": 1 } }'


  public editor: DecoupledEditor = {} as DecoupledEditor;
  public globalAreaReference!: HTMLElement;
  constructor(
    private elementRef: ElementRef,
    @Inject(Router) private router: Router,
    private dialogService: DialogService,
    private fileService: FileService,
    private editService: EditService,
    private assetService: AssetService,
    private clipboard: Clipboard,
    private messageService: MessageService
  ) { }

  showFileUploadPopup(): void {
    const ref = this.dialogService.open(FileUploadPopupComponent, {
      header: 'Upload Files',
      showHeader: true,
      closable: true,
      closeOnEscape: true,
      dismissableMask: true,
    });
  }

  async ngOnInit(): Promise<void> {
    this.speedDialItems = [
      {
        icon: 'pi pi-pencil',
        command: () => {
          this.navigateToPage('edit');
        },
      },
      {
        icon: 'pi pi-refresh',
        command: () => {
          // this.messageService.add({ severity: 'success', summary: 'Update', detail: 'Data Updated' });
        },
      },
      {
        icon: 'pi pi-trash',
        command: () => {
          // this.messageService.add({ severity: 'error', summary: 'Delete', detail: 'Data Deleted' });
        },
      },
      {
        icon: 'pi pi-upload',
        command: () => {
          this.showFileUploadPopup();
        },
      },
      {
        icon: 'pi pi-external-link',
      },
    ];
    this.fileName = this.editService.getName();
  }

  ngAfterViewInit() {
    //Waits a small amount of time to fetch content from editService.
    let editableArea = this.elementRef.nativeElement.querySelector(
      '.document-editor__editable'
    );
    this.globalAreaReference = editableArea; //set to avoid constant referencing
    const toolbarContainer: HTMLElement =
      this.elementRef.nativeElement.querySelector('.document-editor__toolbar');
    if (editableArea && toolbarContainer) {
      DecoupledEditor.create(editableArea, {
        toolbar: {
          items: [
            'undo', 'redo',
            '|', 'heading',
            '|', 'fontfamily', 'fontsize', 'fontColor', 'fontBackgroundColor',
            '|', 'bold', 'italic', 'underline', 'strikethrough',
            '|', 'link', 'insertTable', 'blockQuote',
            '|', 'alignment',
            '|', 'bulletedList', 'numberedList', 'todoList', 'outdent', 'indent'
          ],
          shouldNotGroupWhenFull: false
        },
        cloudServices: {
          //TODO Great for Collaboration features.
        },
        // plugins: [PageBreak],
        link: {
          // Automatically add target="_blank" and rel="noopener noreferrer" to all external links.
          addTargetToExternalLinks: true,
        },
      })
        .then((editor) => {
          // Apply assertion for toolbarContainer
          // (toolbarContainer as Node).appendChild(editor.ui.view.toolbar.element as Node);
          editor.ui.view.toolbar.element?.style.setProperty(
            'background',
            '#00000000'
          );
          editor.ui.view.toolbar.element?.style.setProperty('border', 'none');
          editor.ui.view.toolbar.element?.style.setProperty(
            'width',
            'calc(100vw - 300px)'
          );
          editor.ui.view.toolbar.element?.style.setProperty(
            'overflow-x',
            'hidden !important'
          );

          document
            .getElementsByClassName('toolsWrapper')[0]
            .appendChild(editor.ui.view.toolbar.element as Node);
          (window as any).editor = editor; // Adding 'editor' to the global window object for testing purposes.
          // Set the saved content after the editor is ready
          editor.setData(<string>this.editService.getContent());
          console.log(<string>this.editService.getContent());
          this.editor = editor;
        })
        .catch((err) => {
          console.error(err);
        });
    }
    this.elementRef.nativeElement.ownerDocument.body.style.backgroundColor =
      '#E3E3E3';
    this.elementRef.nativeElement.ownerDocument.body.style.overflow = 'hidden';
    this.refreshSidebar();
  }

  navigateToPage(pageName: string) {
    this.editService.setContent(this.editor.getData());
    this.saveDocumentContents();
    this.router.navigate([`/${pageName}`]);
  }

  navigateToCameraPage() {
    this.editService.setContent(this.editor.getData());
    this.saveDocumentContents();
    const data = {
      ParentFolderId: this.editService.getParentFolderID(),
      Path: this.editService.getPath(),
    };
    console.log('On move to cam page: ' + this.editService.getParentFolderID());
    this.router.navigate(['/camera'], { state: data });
  }

  saveDocumentContents() {
    // Save the document quill content to localStorage when changes occur
    // const editableArea: HTMLElement = this.elementRef.nativeElement.querySelector('.document-editor__editable');
    let contents = this.editor.getData();
    console.log('Before function call save:' + contents);
    this.fileService.saveDocument(
      contents,
      this.editService.getMarkdownID(),
      this.editService.getPath()
    );
    console.log('After function call save:' + contents);
  }

  hideSideBar() {
    // get asset sidebar and set display none
    const sidebar = document.getElementsByClassName('assetSidebar')[0];
    const editor = document.getElementsByClassName('editor')[0];
    const showAssetSidebar =
      document.getElementsByClassName('showAssetSidebar')[0];
    if (sidebar && editor && showAssetSidebar) {
      if (this.sidebarVisible) {
        //then hide the sidebar
        console.log('hide');
        editor.setAttribute('style', 'left:0px;width:100%;margin:auto;');
        sidebar.setAttribute('style', 'display:none');
        showAssetSidebar.setAttribute('style', 'display:block');
        this.sidebarVisible = false;
      } else {
        //then show the sidebar

        editor.setAttribute('style', 'padding-right: 0px;left:260px');
        sidebar.setAttribute('style', 'display:block');
        showAssetSidebar.setAttribute('style', 'display:none');
        this.sidebarVisible = true;
      }
    }

    this.reCenterPage();
  }

  renameDocument() {
    console.log('rename');
    this.fileService
      .renameDocument(
        this.editService.getMarkdownID(),
        this.fileName,
        this.editService.getPath()
      )
      .then((Boolean) => {
        if (Boolean) {
          this.editService.setName(this.fileName);
        }
      });
  }

  showDialog() {
    this.exportDialogVisible = true;
  }

  async retrieveAsset(assetId: string, format: string) {
    const asset = await this.assetService.retrieveAsset(assetId, format);
    // const asset = true;
    console.log(asset);
    if (asset) {
      console.log('asset', this.mock);
      if (format === 'text') {
        this.textFromAsset = [];
        this.parseAssetText(JSON.parse(this.mock));
        this.textCopyDialog = true;
      }
      else if (format === 'image') {
        this.copyHtmlToClipboard(`<img src="${asset.Content}" alt="Image">`);
        this.messageService.add({
          severity: 'success',
          summary: 'Success',
          detail: 'Image copied to clipboard',
        });
      }
    }
  }

  parseAssetText(asset: any) {

    for (let i = 0; i < asset.Blocks.length; i++) {
      if (asset.Blocks[i].BlockType === 'LINE')
        this.textFromAsset.push(asset.Blocks[i].Text);
    }
  }

  copyHtmlToClipboard(html: string) {
    // Use the Clipboard API to copy the data to the clipboard
    navigator.clipboard.write([
      new ClipboardItem({
        'text/html': new Blob([html], { type: 'text/html' })
      })
    ]).then(
      () => {
        console.log('HTML data (image) copied to clipboard successfully!');
      },
      (error) => {
        console.error('Could not copy HTML data (image) to clipboard: ', error);
      }
    );
  }

  copyTextToClipboard(text: string) {
    // Use the Clipboard API to copy the data to the clipboard
    navigator.clipboard.write([
      new ClipboardItem({
        'text/plain': new Blob([text], { type: 'text/plain' })
      })
    ]).then(
      () => {
        this.messageService.add({
          severity: 'success',
          summary: 'Success',
          detail: 'Text copied to clipboard',
        });
        this.textCopyDialog = false;
      },
      (error) => {
        console.error('Could not copy text to clipboard: ', error);
      }
    );
  }


  async deleteAsset(assetId: string) {
    if (await this.assetService.deleteAsset(assetId)) {
      this.messageService.add({
        severity: 'success',
        summary: 'Success',
        detail: 'Asset deleted',
      });
      await this.refreshSidebar();
    }
  }

  async renameAsset(assetId: string, event: Event) {
    const inputElement = event.target as HTMLInputElement;
    const inputValue = inputElement.value;
    const asset = await this.assetService.renameAsset(assetId, inputValue);
    console.log(asset);
    for (let i = 0; i < this.assets.length; i++) {
      if (this.assets[i].Id === assetId) {
        this.assets[i].FileName = inputValue;
      }
    }
  }

  async refreshSidebar() {
    this.assets = await this.assetService.retrieveAll(
      this.editService.getParentFolderID()
    );
  }

  pageBreak() {
    this.editor.execute('pageBreak');
  }

  zoomIn() {
    if (this.currentZoom >= 2) return;
    this.currentZoom += 0.1; // Increase zoom by 10% (adjust as needed)
    this.currentZoom = parseFloat(this.currentZoom.toFixed(1));
    const element = document.getElementsByClassName(
      'center-page'
    )[0] as HTMLElement;
    element.style.transform = `scale(${this.currentZoom})`;
    element.style.transformOrigin = 'center top'; // Change the origin to the top left corner (adjust as needed)
    element.style.marginLeft = 'auto';
    this.reCenterPage();
  }

  zoomOut() {
    if (this.currentZoom <= 0.5) return;
    this.currentZoom -= 0.1; // Decrease zoom by 10% (adjust as needed)
    this.currentZoom = parseFloat(this.currentZoom.toFixed(1));
    const element = document.getElementsByClassName(
      'center-page'
    )[0] as HTMLElement;
    element.style.transform = `scale(${this.currentZoom})`;
    element.style.transformOrigin = 'center top'; // Change the origin to the top left corner (adjust as needed)
    this.reCenterPage();
  }

  reCenterPage() {
    const element = document.getElementsByClassName(
      'center-page'
    )[0] as HTMLElement;
    element.style.marginLeft = 'auto';
    if (this.sidebarVisible) {
      const leftPosition = this.getLeftPosition(element);
      if (leftPosition < 250) {
        element.style.marginLeft = '0';
        element.style.marginLeft = `${(270 - this.getLeftPosition(element))}px`;
      }
    } else {
      const leftPosition = this.getLeftPosition(element);
      if (leftPosition < -10) {
        element.style.marginLeft = '0';
        element.style.marginLeft = `${(20 - this.getLeftPosition(element))}px`;
      }
    }
  }

  getLeftPosition(element: HTMLElement): number {
    const rect = element.getBoundingClientRect();
    return rect.left;
  }


  //Functions for exporting from HTML
  convertToFileType(fileType: string) {
    let contents = `<body style="word-break: normal; font-family: Arial, Helvetica, sans-serif;">${this.editor.getData()}</body>`;
    console.log(contents);
    const markdownID = this.editService.getMarkdownID();
    const name = this.editService.getName();
    if (markdownID && name) {
      this.fileService.exportDocumentToNewFileType(
        markdownID,
        name,
        contents,
        fileType
      );
    }
  }
}
